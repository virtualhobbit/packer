{
  "builders": [
    {
      "type":                      "vsphere-iso",

      "vcenter_server":            "{{user `vcenter_server`}}",
      "username":                  "{{user `username`}}",
      "password":                  "{{user `password`}}",
      "insecure_connection":       true,

      "vm_name":                   "CentOS 7",
      "vm_version":                15,
      "guest_os_type":             "centos7_64Guest",
      "boot_order":                "disk,cdrom",
      "create_snapshot":           false,
      "convert_to_template":       true,

      "cluster":                   "{{user `cluster`}}",
      "CPUs":                      1,
      "RAM":                       2048,

      "datastore":                 "{{user `datastore`}}",
      "folder":                    "{{user `folder`}}",
      "disk_controller_type":      "pvscsi",
      "storage": [
        {
          "disk_size":             16384,
          "disk_thin_provisioned": true
        }
      ],
      "iso_paths":                 "[{{user `datastore_iso`}}] CentOS-7-x86_64-DVD-2003.iso",
      "remove_cdrom":              true,

      "network_adapters": [
        {
          "network":               "{{user `network`}}",
          "network_card":          "vmxnet3"
        }
      ],

      "notes":                     "Base OS, VMware Tools, patched up to {{isotime \"20060102\"}}",

      "boot_command": [
        "<up><wait><tab><wait> text ks=http://intranet.mdb-lab.com/centos-7.cfg<enter><wait>"
      ],
      "shutdown_command":          "echo '{{user `ssh_password`}}' | sudo -S -E shutdown -P now",

      "communicator":              "ssh",
      "ssh_username":              "{{user `ssh_username`}}",
      "ssh_password":              "{{user `ssh_password`}}"
    }
  ],
  "provisioners": [
    {
      "type":                      "shell",
      "execute_command":           "echo '{{user `ssh_password`}}' | sudo -S -E bash '{{.Path}}'",
      "scripts": [
        "setup/update.sh"
      ]
    }
  ]
}
